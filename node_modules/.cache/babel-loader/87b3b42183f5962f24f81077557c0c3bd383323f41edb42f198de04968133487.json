{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Card,Button,Alert,Typography,Space}from'antd';import{ReloadOutlined,CheckCircleOutlined,ExclamationCircleOutlined}from'@ant-design/icons';import stockApi from'../services/stockApi';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const{Text}=Typography;const ApiTestComponent=_ref=>{let{symbol='NVDA'}=_ref;const[testResult,setTestResult]=useState({status:'idle',message:''});const testAPI=async currentSymbol=>{setTestResult({status:'loading',message:'正在测试API连接...'});try{const data=await stockApi.getStockQuote(currentSymbol);setTestResult({status:'success',message:'API连接成功！',data:data});}catch(error){const errorMessage=error instanceof Error?error.message:'未知错误';setTestResult({status:'error',message:\"API\\u8FDE\\u63A5\\u5931\\u8D25: \".concat(errorMessage)});}};useEffect(()=>{let isCancelled=false;const runTest=async()=>{if(!isCancelled){await testAPI(symbol);}};runTest();return()=>{isCancelled=true;};},[symbol]);const getStatusIcon=()=>{switch(testResult.status){case'loading':return/*#__PURE__*/_jsx(ReloadOutlined,{spin:true});case'success':return/*#__PURE__*/_jsx(CheckCircleOutlined,{style:{color:'#52c41a'}});case'error':return/*#__PURE__*/_jsx(ExclamationCircleOutlined,{style:{color:'#ff4d4f'}});default:return null;}};return/*#__PURE__*/_jsx(Card,{title:\"API\\u8FDE\\u63A5\\u6D4B\\u8BD5\",style:{margin:'20px'},children:/*#__PURE__*/_jsxs(Space,{direction:\"vertical\",size:\"large\",style:{width:'100%'},children:[/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:/*#__PURE__*/_jsxs(Space,{size:\"middle\",children:[getStatusIcon(),/*#__PURE__*/_jsx(Text,{strong:true,children:testResult.message})]})}),testResult.status==='success'&&testResult.data&&/*#__PURE__*/_jsx(Alert,{message:\"API\\u6570\\u636E\\u83B7\\u53D6\\u6210\\u529F\",description:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u80A1\\u7968\\u4EE3\\u7801:\"}),\" \",testResult.data.symbol]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u516C\\u53F8\\u540D\\u79F0:\"}),\" \",testResult.data.longName]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u5F53\\u524D\\u4EF7\\u683C:\"}),\" $\",testResult.data.price]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"\\u6DA8\\u8DCC\\u5E45:\"}),\" \",testResult.data.changePercent,\"%\"]})]}),type:\"success\",showIcon:true}),testResult.status==='error'&&/*#__PURE__*/_jsx(Alert,{message:\"API\\u8FDE\\u63A5\\u5931\\u8D25\",description:\"\\u7CFB\\u7EDF\\u5C06\\u4F7F\\u7528\\u5907\\u7528\\u6570\\u636E\\u6E90\\uFF0C\\u529F\\u80FD\\u4ECD\\u7136\\u53EF\\u7528\",type:\"warning\",showIcon:true}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center'},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",icon:/*#__PURE__*/_jsx(ReloadOutlined,{}),onClick:()=>testAPI(symbol),loading:testResult.status==='loading',children:\"\\u91CD\\u65B0\\u6D4B\\u8BD5\"})})]})});};export default ApiTestComponent;","map":{"version":3,"names":["React","useState","useEffect","Card","Button","Alert","Typography","Space","ReloadOutlined","CheckCircleOutlined","ExclamationCircleOutlined","stockApi","jsx","_jsx","jsxs","_jsxs","Text","ApiTestComponent","_ref","symbol","testResult","setTestResult","status","message","testAPI","currentSymbol","data","getStockQuote","error","errorMessage","Error","concat","isCancelled","runTest","getStatusIcon","spin","style","color","title","margin","children","direction","size","width","textAlign","strong","description","longName","price","changePercent","type","showIcon","icon","onClick","loading"],"sources":["/Users/cody/Desktop/tencent/stocks/src/components/ApiTestComponent.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Card, Button, Alert, Typography, Space } from 'antd';\nimport { ReloadOutlined, CheckCircleOutlined, ExclamationCircleOutlined } from '@ant-design/icons';\nimport stockApi from '../services/stockApi';\n\nconst { Text } = Typography;\n\ninterface ApiTestComponentProps {\n  symbol?: string;\n}\n\nconst ApiTestComponent: React.FC<ApiTestComponentProps> = ({ symbol = 'NVDA' }) => {\n  const [testResult, setTestResult] = useState<{\n    status: 'loading' | 'success' | 'error' | 'idle';\n    message: string;\n    data?: any;\n  }>({ status: 'idle', message: '' });\n\n  const testAPI = async (currentSymbol: string) => {\n    setTestResult({ status: 'loading', message: '正在测试API连接...' });\n\n    try {\n      const data = await stockApi.getStockQuote(currentSymbol);\n      setTestResult({\n        status: 'success',\n        message: 'API连接成功！',\n        data: data\n      });\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : '未知错误';\n      setTestResult({\n        status: 'error',\n        message: `API连接失败: ${errorMessage}`\n      });\n    }\n  };\n\n  useEffect(() => {\n    let isCancelled = false;\n\n    const runTest = async () => {\n      if (!isCancelled) {\n        await testAPI(symbol);\n      }\n    };\n\n    runTest();\n\n    return () => {\n      isCancelled = true;\n    };\n  }, [symbol]);\n\n  const getStatusIcon = () => {\n    switch (testResult.status) {\n      case 'loading':\n        return <ReloadOutlined spin />;\n      case 'success':\n        return <CheckCircleOutlined style={{ color: '#52c41a' }} />;\n      case 'error':\n        return <ExclamationCircleOutlined style={{ color: '#ff4d4f' }} />;\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Card title=\"API连接测试\" style={{ margin: '20px' }}>\n      <Space direction=\"vertical\" size=\"large\" style={{ width: '100%' }}>\n        <div style={{ textAlign: 'center' }}>\n          <Space size=\"middle\">\n            {getStatusIcon()}\n            <Text strong>{testResult.message}</Text>\n          </Space>\n        </div>\n\n        {testResult.status === 'success' && testResult.data && (\n          <Alert\n            message=\"API数据获取成功\"\n            description={\n              <div>\n                <p><strong>股票代码:</strong> {testResult.data.symbol}</p>\n                <p><strong>公司名称:</strong> {testResult.data.longName}</p>\n                <p><strong>当前价格:</strong> ${testResult.data.price}</p>\n                <p><strong>涨跌幅:</strong> {testResult.data.changePercent}%</p>\n              </div>\n            }\n            type=\"success\"\n            showIcon\n          />\n        )}\n\n        {testResult.status === 'error' && (\n          <Alert\n            message=\"API连接失败\"\n            description=\"系统将使用备用数据源，功能仍然可用\"\n            type=\"warning\"\n            showIcon\n          />\n        )}\n\n        <div style={{ textAlign: 'center' }}>\n          <Button\n            type=\"primary\"\n            icon={<ReloadOutlined />}\n            onClick={() => testAPI(symbol)}\n            loading={testResult.status === 'loading'}\n          >\n            重新测试\n          </Button>\n        </div>\n      </Space>\n    </Card>\n  );\n};\n\nexport default ApiTestComponent;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}